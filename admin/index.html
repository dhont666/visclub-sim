<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Visclub SiM</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="admin-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-fish"></i>
                <span>Visclub SiM</span>
            </div>

            <nav class="sidebar-nav">
                <a href="index.html" class="nav-item active">
                    <i class="fas fa-chart-line"></i>
                    <span>Overzicht</span>
                </a>
                <a href="contact-berichten.html" class="nav-item">
                    <i class="fas fa-envelope"></i>
                    <span>Contact Berichten</span>
                    <span class="badge" id="unreadContactBadge">0</span>
                </a>
                <a href="vergunningen.html" class="nav-item">
                    <i class="fas fa-file-contract"></i>
                    <span>Vergunningen</span>
                    <span class="badge warning" id="pendingPermitsBadge">0</span>
                </a>
                <a href="plaatsentrekking.html" class="nav-item">
                    <i class="fas fa-random"></i>
                    <span>Plaatsentrekking</span>
                </a>
                <a href="weging.html" class="nav-item">
                    <i class="fas fa-weight"></i>
                    <span>Weging</span>
                </a>
                <a href="demo-data-setup.html" class="nav-item" style="border-left: 3px solid #ffc107;">
                    <i class="fas fa-database"></i>
                    <span>Demo Data</span>
                </a>
                <a href="klassement-beheer.html" class="nav-item">
                    <i class="fas fa-trophy"></i>
                    <span>Klassement</span>
                </a>
                <a href="admin-chat.html" class="nav-item">
                    <i class="fas fa-comments"></i>
                    <span>Admin Chat</span>
                    <span class="badge" id="unreadChatBadge" style="display: none;">0</span>
                </a>
                <a href="../leden.html" class="nav-item" target="_blank">
                    <i class="fas fa-id-card"></i>
                    <span>Leden (bekijken)</span>
                </a>
                <a href="../home.html" class="nav-item" target="_blank">
                    <i class="fas fa-home"></i>
                    <span>Website Bekijken</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Instellingen</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <button class="btn-logout" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Uitloggen</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-left">
                    <h1 id="pageTitle">Overzicht</h1>
                    <p id="pageSubtitle">Dashboard statistieken en recente activiteit</p>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Zoeken...">
                    </div>
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <div style="display: flex; flex-direction: column; align-items: flex-start;">
                            <span id="adminName" style="font-weight: 600;">Admin</span>
                            <small id="adminRole" style="opacity: 0.7; font-size: 11px;">Admin</small>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Dashboard Sections -->
            <div class="content-body">
                <!-- Overview Section -->
                <section id="section-overview" class="dashboard-section active">
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card blue">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="totalMembers">0</h3>
                                <p>Totaal Leden</p>
                                <small class="trend" id="membersTrend">
                                    <i class="fas fa-users"></i> Actieve leden
                                </small>
                            </div>
                        </div>

                        <div class="stat-card green">
                            <div class="stat-icon">
                                <i class="fas fa-user-check"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="nextCompetitionRegistrations">0</h3>
                                <p>Inschrijvingen Volgende Wedstrijd</p>
                                <small class="trend" id="nextCompetitionName">
                                    <i class="fas fa-calendar"></i> Laden...
                                </small>
                            </div>
                        </div>

                        <div class="stat-card orange">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="pendingPayments">0</h3>
                                <p>Openstaand</p>
                                <small class="trend" id="pendingAmount">
                                    <i class="fas fa-euro-sign"></i> ‚Ç¨0,00
                                </small>
                            </div>
                        </div>

                        <div class="stat-card purple">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="upcomingCompetitions">0</h3>
                                <p>Aankomende Wedstrijden</p>
                                <small class="trend" id="nextCompetitionDate">
                                    <i class="fas fa-info-circle"></i> Laden...
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Messages Notification -->
                    <div class="activity-card" id="contactMessagesCard" style="margin-bottom: 30px; display: none; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid #4caf50;">
                        <div class="card-header">
                            <h3><i class="fas fa-envelope"></i> Nieuwe Contact Berichten</h3>
                            <a href="contact-berichten.html" class="btn btn-primary btn-small">
                                <i class="fas fa-eye"></i> Bekijk Alles
                            </a>
                        </div>
                        <div class="activity-list" id="contactMessagesList">
                            <!-- Messages will be loaded here -->
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity-card" style="margin-bottom: 30px;">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Recente Activiteit</h3>
                        </div>
                        <div class="activity-list" id="recentActivityList">
                            <div style="text-align: center; padding: 40px 20px; color: #999;">
                                <i class="fas fa-history" style="font-size: 48px; margin-bottom: 15px; opacity: 0.3;"></i>
                                <p>Nog geen recente activiteit</p>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h3><i class="fas fa-bolt"></i> Snelle Acties</h3>
                        <div class="actions-grid">
                            <button class="action-btn" onclick="window.location.href='weging.html'" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                                <i class="fas fa-weight"></i>
                                <span>Weging Invoeren</span>
                            </button>
                            <button class="action-btn" onclick="window.open('../live-uitslag.html', '_blank')" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);">
                                <i class="fas fa-tv"></i>
                                <span>Live Uitslag</span>
                            </button>
                            <button class="action-btn" onclick="switchSection('registrations')">
                                <i class="fas fa-user-plus"></i>
                                <span>Nieuwe Inschrijving</span>
                            </button>
                            <button class="action-btn" onclick="switchSection('emails')">
                                <i class="fas fa-paper-plane"></i>
                                <span>Stuur Email</span>
                            </button>
                            <button class="action-btn" onclick="exportData()">
                                <i class="fas fa-download"></i>
                                <span>Exporteer Data</span>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Registrations Section -->
                <section id="section-registrations" class="dashboard-section">
                    <div class="section-toolbar">
                        <div class="toolbar-left">
                            <button class="btn btn-primary" onclick="showNewRegistration()">
                                <i class="fas fa-plus"></i> Nieuwe Inschrijving
                            </button>
                            <button class="btn btn-secondary" onclick="exportRegistrations()">
                                <i class="fas fa-download"></i> Exporteer
                            </button>
                        </div>
                        <div class="toolbar-right">
                            <select id="competitionFilter" class="filter-select">
                                <option value="all">Alle Wedstrijden</option>
                                <option value="upcoming">Aankomend</option>
                                <option value="past">Afgelopen</option>
                            </select>
                            <select id="statusFilter" class="filter-select">
                                <option value="all">Alle Statussen</option>
                                <option value="paid">Betaald</option>
                                <option value="pending">Openstaand</option>
                            </select>
                        </div>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="selectAll"></th>
                                    <th>ID</th>
                                    <th>Naam</th>
                                    <th>Email</th>
                                    <th>Wedstrijd</th>
                                    <th>Type</th>
                                    <th>Betaling</th>
                                    <th>Datum</th>
                                    <th>Acties</th>
                                </tr>
                            </thead>
                            <tbody id="registrationsTable">
                                <!-- Data will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>

                    <div class="table-pagination">
                        <div class="pagination-info">
                            Toon 1-10 van 45 resultaten
                        </div>
                        <div class="pagination-controls">
                            <button class="btn-page" disabled><i class="fas fa-chevron-left"></i></button>
                            <button class="btn-page active">1</button>
                            <button class="btn-page">2</button>
                            <button class="btn-page">3</button>
                            <button class="btn-page"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Payments Section -->
                <section id="section-payments" class="dashboard-section">
                    <div class="payments-stats">
                        <div class="payment-stat">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <h4>‚Ç¨380,00</h4>
                                <p>Ontvangen</p>
                            </div>
                        </div>
                        <div class="payment-stat">
                            <i class="fas fa-clock"></i>
                            <div>
                                <h4>‚Ç¨70,00</h4>
                                <p>Openstaand</p>
                            </div>
                        </div>
                        <div class="payment-stat">
                            <i class="fas fa-chart-pie"></i>
                            <div>
                                <h4>84%</h4>
                                <p>Betaalratio</p>
                            </div>
                        </div>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Referentie</th>
                                    <th>Naam</th>
                                    <th>Wedstrijd</th>
                                    <th>Bedrag</th>
                                    <th>Status</th>
                                    <th>Datum</th>
                                    <th>Acties</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTable">
                                <!-- Data will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Competitions Section -->
                <section id="section-competitions" class="dashboard-section">
                    <div class="section-toolbar">
                        <button class="btn btn-primary" onclick="addCompetition()">
                            <i class="fas fa-plus"></i> Nieuwe Wedstrijd
                        </button>
                        <button class="btn btn-secondary" onclick="importCalendar()">
                            <i class="fas fa-upload"></i> Importeer Kalender
                        </button>
                    </div>

                    <div class="competitions-grid" id="competitionsGrid">
                        <!-- Competition cards will be loaded dynamically -->
                    </div>
                </section>

                <!-- Draw Section -->
                <section id="section-draw" class="dashboard-section">
                    <div class="draw-interface">
                        <div class="draw-setup">
                            <h3>Plaatsentrekking Configureren</h3>

                            <div class="form-group">
                                <label>Selecteer Wedstrijd</label>
                                <select id="drawCompetition" class="form-control">
                                    <option>07-03-2026 - Vrije Gewone</option>
                                    <option>14-03-2026 - Vrije Koppel</option>
                                </select>
                            </div>

                            <div class="draw-stats">
                                <div class="draw-stat-item">
                                    <strong>12</strong>
                                    <span>Deelnemers</span>
                                </div>
                                <div class="draw-stat-item">
                                    <strong>43</strong>
                                    <span>Beschikbare Plaatsen</span>
                                </div>
                            </div>

                            <button class="btn btn-primary btn-large" onclick="startAdminDraw()">
                                <i class="fas fa-random"></i> Start Automatische Trekking
                            </button>
                        </div>

                        <div class="draw-results" id="drawResults" style="display: none;">
                            <!-- Draw results will appear here -->
                        </div>
                    </div>
                </section>

                <!-- Members Section -->
                <section id="section-members" class="dashboard-section">
                    <div class="section-toolbar">
                        <button class="btn btn-primary" onclick="addMember()">
                            <i class="fas fa-user-plus"></i> Nieuw Lid
                        </button>
                        <button class="btn btn-secondary" onclick="exportMembers()">
                            <i class="fas fa-download"></i> Exporteer Leden
                        </button>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Lidnr.</th>
                                    <th>Naam</th>
                                    <th>Email</th>
                                    <th>Telefoon</th>
                                    <th>Type</th>
                                    <th>Geldig tot</th>
                                    <th>Acties</th>
                                </tr>
                            </thead>
                            <tbody id="membersTable">
                                <!-- Data will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Permits Section -->
                <section id="section-permits" class="dashboard-section">
                    <div class="section-toolbar">
                        <button class="btn btn-primary" onclick="addPermit()">
                            <i class="fas fa-plus"></i> Nieuwe Vergunning
                        </button>
                        <button class="btn btn-secondary" onclick="exportPermits()">
                            <i class="fas fa-download"></i> Exporteer Vergunningen
                        </button>
                    </div>

                    <!-- Vergunning Info Cards -->
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card blue">
                            <div class="stat-icon">
                                <i class="fas fa-file-contract"></i>
                            </div>
                            <div class="stat-details">
                                <h3 id="permits-total">0</h3>
                                <p>Totaal Aanvragen</p>
                            </div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-icon">
                                <i class="fas fa-hourglass-half"></i>
                            </div>
                            <div class="stat-details">
                                <h3 id="permits-pending">0</h3>
                                <p>In Behandeling</p>
                            </div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-details">
                                <h3 id="permits-approved">0</h3>
                                <p>Goedgekeurd</p>
                            </div>
                        </div>
                    </div>

                    <!-- Permit Types Info -->
                    <div class="info-box" style="margin-bottom: 20px; padding: 20px; background: #e7f3ff; border-radius: 8px; border-left: 4px solid #0066cc;">
                        <h4 style="margin-bottom: 15px; color: #0066cc;"><i class="fas fa-info-circle"></i> Vergunning Types & Prijzen</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 6px;">
                                <strong style="color: #2c5f7d;">üé£ Jaarvergunning</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #666;">‚Ç¨75,00 - Vrij vissen op 3 vijvers</p>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 6px;">
                                <strong style="color: #2c5f7d;">üèÜ Wedstrijdvisser</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #666;">‚Ç¨60,00 - Deelname alle wedstrijden</p>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 6px;">
                                <strong style="color: #2c5f7d;">üë¶ Jeugd (-16 jaar)</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #666;">50% korting (‚Ç¨37,50 / ‚Ç¨30,00)</p>
                            </div>
                        </div>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Naam</th>
                                    <th>Email</th>
                                    <th>Type</th>
                                    <th>Jeugd</th>
                                    <th>Bedrag</th>
                                    <th>Status</th>
                                    <th>Aangevraagd</th>
                                    <th>Acties</th>
                                </tr>
                            </thead>
                            <tbody id="permitsTable">
                                <!-- Data will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Emails Section -->
                <section id="section-emails" class="dashboard-section">
                    <div class="email-composer">
                        <h3><i class="fas fa-paper-plane"></i> Email Versturen</h3>

                        <form id="emailForm">
                            <div class="form-group">
                                <label>Ontvangers Type</label>
                                <select id="recipientType" class="form-control" onchange="toggleCustomEmail()">
                                    <option value="group">Groep selectie</option>
                                    <option value="custom">Custom email adres</option>
                                </select>
                            </div>

                            <div class="form-group" id="groupSelection">
                                <label>Ontvangers Groep</label>
                                <select class="form-control" multiple>
                                    <option>Alle leden</option>
                                    <option>Ingeschreven deelnemers (07-03-2026)</option>
                                    <option>Openstaande betalingen</option>
                                </select>
                            </div>

                            <div class="form-group" id="customEmailField" style="display: none;">
                                <label>Email Adres</label>
                                <input type="email" id="customEmailInput" class="form-control" placeholder="naam@voorbeeld.be">
                                <small style="color: #666; font-size: 13px; display: block; margin-top: 5px;">
                                    <i class="fas fa-info-circle"></i> Voor meerdere adressen, scheid met komma's
                                </small>
                            </div>

                            <div class="form-group">
                                <label>Onderwerp</label>
                                <input type="text" id="emailSubject" class="form-control" placeholder="Email onderwerp">
                            </div>

                            <div class="form-group">
                                <label>Bericht</label>
                                <textarea class="form-control" rows="10" placeholder="Email inhoud..."></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> Verstuur
                                </button>
                                <button type="button" class="btn btn-secondary">
                                    <i class="fas fa-save"></i> Opslaan als Concept
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="email-templates">
                        <h4>Email Templates</h4>
                        <div class="templates-list">
                            <div class="template-item">
                                <i class="fas fa-envelope"></i>
                                <span>Bevestiging Inschrijving</span>
                                <button class="btn-small">Gebruik</button>
                            </div>
                            <div class="template-item">
                                <i class="fas fa-bell"></i>
                                <span>Reminder Wedstrijd</span>
                                <button class="btn-small">Gebruik</button>
                            </div>
                            <div class="template-item">
                                <i class="fas fa-exclamation-circle"></i>
                                <span>Betaling Herinnering</span>
                                <button class="btn-small">Gebruik</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Bot Section -->
                <section id="section-bot" class="dashboard-section">
                    <div class="bot-admin-container">
                        <div class="bot-header-card">
                            <div class="bot-header-content">
                                <div class="bot-icon-large">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <h2>üêü Vis Advies Bot</h2>
                                    <p>AI-gestuurde bot die bezoekers helpt met vis advies, weer tips en aas keuze</p>
                                </div>
                            </div>
                            <div class="bot-status-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="botEnabled" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Bot Actief</span>
                            </div>
                        </div>

                        <div class="bot-stats-grid">
                            <div class="bot-stat-card">
                                <div class="stat-icon blue">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div class="stat-details">
                                    <h3>156</h3>
                                    <p>Totaal Conversaties</p>
                                    <small>Laatste 30 dagen</small>
                                </div>
                            </div>

                            <div class="bot-stat-card">
                                <div class="stat-icon green">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-details">
                                    <h3>89</h3>
                                    <p>Unieke Bezoekers</p>
                                    <small>Deze maand</small>
                                </div>
                            </div>

                            <div class="bot-stat-card">
                                <div class="stat-icon orange">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                                <div class="stat-details">
                                    <h3>342</h3>
                                    <p>Vragen Beantwoord</p>
                                    <small>Totaal</small>
                                </div>
                            </div>

                            <div class="bot-stat-card">
                                <div class="stat-icon purple">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-details">
                                    <h3>4.8</h3>
                                    <p>Gebruikers Score</p>
                                    <small>Van 5 sterren</small>
                                </div>
                            </div>
                        </div>

                        <div class="bot-content-grid">
                            <!-- Popular Questions -->
                            <div class="bot-card">
                                <h3><i class="fas fa-fire"></i> Populaire Vragen</h3>
                                <div class="popular-questions">
                                    <div class="question-item">
                                        <span class="question-rank">1</span>
                                        <div class="question-content">
                                            <strong>Wat zijn de beste weersomstandigheden?</strong>
                                            <small>45 keer gevraagd</small>
                                        </div>
                                    </div>
                                    <div class="question-item">
                                        <span class="question-rank">2</span>
                                        <div class="question-content">
                                            <strong>Welk aas voor karper?</strong>
                                            <small>38 keer gevraagd</small>
                                        </div>
                                    </div>
                                    <div class="question-item">
                                        <span class="question-rank">3</span>
                                        <div class="question-content">
                                            <strong>Beste seizoen om te vissen?</strong>
                                            <small>32 keer gevraagd</small>
                                        </div>
                                    </div>
                                    <div class="question-item">
                                        <span class="question-rank">4</span>
                                        <div class="question-content">
                                            <strong>Luchtdruk invloed?</strong>
                                            <small>28 keer gevraagd</small>
                                        </div>
                                    </div>
                                    <div class="question-item">
                                        <span class="question-rank">5</span>
                                        <div class="question-content">
                                            <strong>Aas voor snoekbaars?</strong>
                                            <small>25 keer gevraagd</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bot Configuration -->
                            <div class="bot-card">
                                <h3><i class="fas fa-cog"></i> Bot Configuratie</h3>
                                <div class="bot-config-form">
                                    <div class="config-item">
                                        <label>Bot Naam</label>
                                        <input type="text" class="form-control" value="Vis Advies Bot">
                                    </div>

                                    <div class="config-item">
                                        <label>Welkomstbericht</label>
                                        <textarea class="form-control" rows="3">Welkom! Ik help je met advies over vistijden, aas en weersomstandigheden.</textarea>
                                    </div>

                                    <div class="config-item">
                                        <label>Auto-respons snelheid (ms)</label>
                                        <input type="number" class="form-control" value="800">
                                        <small>Simuleer menselijke typsnelheid</small>
                                    </div>

                                    <div class="config-toggle">
                                        <label>
                                            <input type="checkbox" checked>
                                            <span>Toon typing indicator</span>
                                        </label>
                                    </div>

                                    <div class="config-toggle">
                                        <label>
                                            <input type="checkbox" checked>
                                            <span>Quick reply suggesties</span>
                                        </label>
                                    </div>

                                    <div class="config-toggle">
                                        <label>
                                            <input type="checkbox" checked>
                                            <span>Welkomstscherm tonen</span>
                                        </label>
                                    </div>

                                    <button class="btn btn-primary">
                                        <i class="fas fa-save"></i> Opslaan
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Bot Testing Area -->
                        <div class="bot-test-area">
                            <h3><i class="fas fa-vial"></i> Test de Bot</h3>
                            <p>Test hier de bot responses voordat ze live gaan</p>

                            <div class="bot-test-interface">
                                <div class="test-questions">
                                    <h4>Test Vragen:</h4>
                                    <button class="test-question-btn" onclick="testBotQuestion('Wat zijn de beste weersomstandigheden?')">
                                        Weer advies
                                    </button>
                                    <button class="test-question-btn" onclick="testBotQuestion('Welk aas voor karper?')">
                                        Karper aas
                                    </button>
                                    <button class="test-question-btn" onclick="testBotQuestion('Beste seizoen?')">
                                        Seizoen tips
                                    </button>
                                    <button class="test-question-btn" onclick="testBotQuestion('Luchtdruk invloed?')">
                                        Luchtdruk
                                    </button>
                                </div>

                                <div class="test-response-area" id="testResponseArea">
                                    <p class="test-placeholder">Klik op een test vraag om de bot response te zien...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Bot Analytics -->
                        <div class="bot-analytics">
                            <h3><i class="fas fa-chart-bar"></i> Analytics</h3>
                            <div class="analytics-grid">
                                <div class="analytics-chart">
                                    <h4>Conversaties per dag (laatste week)</h4>
                                    <div class="simple-chart">
                                        <div class="chart-bar" style="height: 60%;" data-value="12">
                                            <span>Ma</span>
                                        </div>
                                        <div class="chart-bar" style="height: 80%;" data-value="16">
                                            <span>Di</span>
                                        </div>
                                        <div class="chart-bar" style="height: 45%;" data-value="9">
                                            <span>Wo</span>
                                        </div>
                                        <div class="chart-bar" style="height: 90%;" data-value="18">
                                            <span>Do</span>
                                        </div>
                                        <div class="chart-bar" style="height: 70%;" data-value="14">
                                            <span>Vr</span>
                                        </div>
                                        <div class="chart-bar" style="height: 100%;" data-value="20">
                                            <span>Za</span>
                                        </div>
                                        <div class="chart-bar" style="height: 85%;" data-value="17">
                                            <span>Zo</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="analytics-topics">
                                    <h4>Meest gevraagde onderwerpen</h4>
                                    <div class="topic-list">
                                        <div class="topic-item">
                                            <span class="topic-name">Weersomstandigheden</span>
                                            <div class="topic-bar">
                                                <div class="topic-fill" style="width: 85%"></div>
                                            </div>
                                            <span class="topic-percent">85%</span>
                                        </div>
                                        <div class="topic-item">
                                            <span class="topic-name">Aas keuze</span>
                                            <div class="topic-bar">
                                                <div class="topic-fill" style="width: 72%"></div>
                                            </div>
                                            <span class="topic-percent">72%</span>
                                        </div>
                                        <div class="topic-item">
                                            <span class="topic-name">Seizoen tips</span>
                                            <div class="topic-bar">
                                                <div class="topic-fill" style="width: 68%"></div>
                                            </div>
                                            <span class="topic-percent">68%</span>
                                        </div>
                                        <div class="topic-item">
                                            <span class="topic-name">Karper vissen</span>
                                            <div class="topic-bar">
                                                <div class="topic-fill" style="width: 55%"></div>
                                            </div>
                                            <span class="topic-percent">55%</span>
                                        </div>
                                        <div class="topic-item">
                                            <span class="topic-name">Snoekbaars</span>
                                            <div class="topic-bar">
                                                <div class="topic-fill" style="width: 42%"></div>
                                            </div>
                                            <span class="topic-percent">42%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="section-settings" class="dashboard-section">
                    <div class="settings-grid">
                        <div class="settings-card">
                            <h3><i class="fas fa-cog"></i> Algemene Instellingen</h3>

                            <div class="form-group">
                                <label>Clubnaam</label>
                                <input type="text" class="form-control" value="Visclub SiM">
                            </div>

                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" class="form-control" value="SimVisclub@gmail.com">
                            </div>

                            <div class="form-group">
                                <label>Rekeningnummer (IBAN)</label>
                                <input type="text" class="form-control" value="BE05 9731 3241 8875">
                            </div>

                            <div class="form-group">
                                <label>Inschrijf termijn (uren van tevoren)</label>
                                <input type="number" class="form-control" value="24">
                                <small style="color: #666; font-size: 12px;">Standaard: 24 uur voor aanvang</small>
                            </div>

                            <button class="btn btn-primary">
                                <i class="fas fa-save"></i> Opslaan
                            </button>
                        </div>

                        <div class="settings-card">
                            <h3><i class="fas fa-euro-sign"></i> Prijzen</h3>

                            <div class="price-settings">
                                <div class="price-item">
                                    <label>Vrije Gewone Wedstrijd</label>
                                    <input type="text" class="form-control" value="‚Ç¨10,00">
                                </div>
                                <div class="price-item">
                                    <label>Vrije Koppelwedstrijd</label>
                                    <input type="text" class="form-control" value="‚Ç¨20,00">
                                </div>
                                <div class="price-item">
                                    <label>Nachtkoppelwedstrijd</label>
                                    <input type="text" class="form-control" value="‚Ç¨30,00">
                                </div>
                                <div class="price-item">
                                    <label>Clubwedstrijd</label>
                                    <input type="text" class="form-control" value="‚Ç¨10,00">
                                </div>
                                <div class="price-item">
                                    <label>Avondwedstrijd</label>
                                    <input type="text" class="form-control" value="‚Ç¨10,00">
                                </div>
                            </div>

                            <button class="btn btn-primary">
                                <i class="fas fa-save"></i> Opslaan
                            </button>
                        </div>

                        <div class="settings-card">
                            <h3><i class="fas fa-bell"></i> Notificaties</h3>

                            <div class="toggle-setting">
                                <label>
                                    <input type="checkbox" checked>
                                    <span>Email bevestiging bij inschrijving</span>
                                </label>
                            </div>

                            <div class="toggle-setting">
                                <label>
                                    <input type="checkbox" checked>
                                    <span>Reminder 7 dagen voor wedstrijd</span>
                                </label>
                            </div>

                            <div class="toggle-setting">
                                <label>
                                    <input type="checkbox" checked>
                                    <span>Betalingsherinnering</span>
                                </label>
                            </div>

                            <div class="toggle-setting">
                                <label>
                                    <input type="checkbox">
                                    <span>Social media automatisch posten</span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h3><i class="fas fa-shield-alt"></i> Beveiliging</h3>

                            <div class="form-group">
                                <label>Wachtwoord wijzigen</label>
                                <input type="password" class="form-control" placeholder="Nieuw wachtwoord">
                            </div>

                            <div class="form-group">
                                <input type="password" class="form-control" placeholder="Bevestig wachtwoord">
                            </div>

                            <button class="btn btn-primary">
                                <i class="fas fa-key"></i> Wijzig Wachtwoord
                            </button>

                            <hr>

                            <button class="btn btn-danger">
                                <i class="fas fa-database"></i> Backup Database
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Calendar Data - Load FIRST so it's available -->
    <script src="../script.js"></script>

    <!-- Admin Authentication -->
    <script src="admin-auth.js"></script>

    <!-- Data API -->
    <script src="data-api.js"></script>

    <!-- Badge System -->
    <script src="admin-badges.js"></script>

    <script>
        // Toggle custom email field
        function toggleCustomEmail() {
            const type = document.getElementById('recipientType').value;
            const groupSelection = document.getElementById('groupSelection');
            const customEmailField = document.getElementById('customEmailField');

            if (type === 'custom') {
                groupSelection.style.display = 'none';
                customEmailField.style.display = 'block';
            } else {
                groupSelection.style.display = 'block';
                customEmailField.style.display = 'none';
            }
        }

        // Load contact messages notification
        function loadContactMessagesNotification() {
            const messages = JSON.parse(localStorage.getItem('contact_messages') || '[]');
            const unreadMessages = messages.filter(m => m.status === 'unread');

            const card = document.getElementById('contactMessagesCard');
            const list = document.getElementById('contactMessagesList');

            if (unreadMessages.length > 0) {
                card.style.display = 'block';

                list.innerHTML = unreadMessages.slice(0, 3).map(msg => {
                    const timeAgo = getTimeAgo(new Date(msg.date));
                    return `
                        <div class="activity-item" style="padding: 15px; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer;" onclick="window.location.href='contact-berichten.html'">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                        <div style="width: 35px; height: 35px; border-radius: 50%; background: #4caf50; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                            ${msg.name.charAt(0).toUpperCase()}
                                        </div>
                                        <div>
                                            <strong style="color: #2c5f7d;">${msg.name}</strong>
                                            <span style="color: #999; font-size: 12px; margin-left: 10px;">${timeAgo}</span>
                                        </div>
                                    </div>
                                    <div style="margin-left: 45px; color: #666;">
                                        <strong>${msg.subject}</strong>
                                        <p style="margin: 5px 0 0 0; font-size: 14px; color: #999; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                            ${msg.message}
                                        </p>
                                    </div>
                                </div>
                                <span style="background: #4caf50; color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                    NIEUW
                                </span>
                            </div>
                        </div>
                    `;
                }).join('');

                if (unreadMessages.length > 3) {
                    list.innerHTML += `
                        <div style="text-align: center; padding: 15px;">
                            <a href="contact-berichten.html" style="color: #2c5f7d; text-decoration: none; font-weight: 600;">
                                + ${unreadMessages.length - 3} meer ongelezen berichten
                            </a>
                        </div>
                    `;
                }
            } else {
                card.style.display = 'none';
            }
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'Zojuist';
            if (minutes < 60) return `${minutes} min geleden`;
            if (hours < 24) return `${hours} uur geleden`;
            if (days === 1) return 'Gisteren';
            return `${days} dagen geleden`;
        }

        // Update user display when page loads
        // Load dashboard stats (separate from admin-script.js)
        async function loadDashboardStats() {
            try {
                // Wait for dataAPI
                let retries = 0;
                while (!window.dataAPI && retries < 20) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    retries++;
                }

                if (!window.dataAPI) {
                    console.error('DataAPI not available');
                    return;
                }

                // Get members
                const members = await window.dataAPI.getMembers();
                document.getElementById('totalMembers').textContent = members.length;
                document.getElementById('membersTrend').innerHTML =
                    `<i class="fas fa-users"></i> ${members.length} actieve leden`;

                // Get registrations
                const registrations = await window.dataAPI.getRegistrations();

                // Find next competition
                const today = window.getCurrentDate ? window.getCurrentDate() : new Date();
                today.setHours(0, 0, 0, 0);

                if (window.calendarData) {
                    const futureCompetitions = window.calendarData.filter(event => {
                        if (event.type === 'vergadering' || event.type === 'bbq') return false;
                        const [day, month, year] = event.datum.split('-').map(Number);
                        const eventDate = new Date(year, month - 1, day);
                        eventDate.setHours(0, 0, 0, 0);
                        return eventDate >= today;
                    }).sort((a, b) => {
                        const [dayA, monthA, yearA] = a.datum.split('-').map(Number);
                        const [dayB, monthB, yearB] = b.datum.split('-').map(Number);
                        const dateA = new Date(yearA, monthA - 1, dayA);
                        const dateB = new Date(yearB, monthB - 1, dayB);
                        return dateA - dateB;
                    });

                    document.getElementById('upcomingCompetitions').textContent = futureCompetitions.length;

                    if (futureCompetitions.length > 0) {
                        const nextComp = futureCompetitions[0];
                        document.getElementById('nextCompetitionDate').innerHTML =
                            `<i class="fas fa-calendar"></i> ${nextComp.datum}`;

                        // Count registrations for next competition
                        const nextCompRegistrations = registrations.filter(reg =>
                            reg.competition.includes(nextComp.datum) ||
                            reg.competition.includes(nextComp.wedstrijdtype)
                        );

                        document.getElementById('nextCompetitionRegistrations').textContent = nextCompRegistrations.length;
                        document.getElementById('nextCompetitionName').innerHTML =
                            `<i class="fas fa-calendar"></i> ${nextComp.wedstrijdtype}`;
                    } else {
                        document.getElementById('nextCompetitionDate').innerHTML =
                            `<i class="fas fa-info-circle"></i> Geen aankomende`;
                        document.getElementById('nextCompetitionRegistrations').textContent = '0';
                        document.getElementById('nextCompetitionName').innerHTML =
                            `<i class="fas fa-calendar"></i> Geen wedstrijd`;
                    }
                }

                // Calculate pending payments
                const pendingRegistrations = registrations.filter(reg => !reg.paid);
                document.getElementById('pendingPayments').textContent = pendingRegistrations.length;

                const pendingAmount = pendingRegistrations.reduce((sum, reg) => {
                    // Estimate amount based on type
                    let amount = 10; // default
                    if (reg.competition.toLowerCase().includes('koppel')) amount = 20;
                    if (reg.competition.toLowerCase().includes('nacht')) amount = 30;
                    return sum + amount;
                }, 0);

                document.getElementById('pendingAmount').innerHTML =
                    `<i class="fas fa-euro-sign"></i> ‚Ç¨${pendingAmount.toFixed(2)}`;

                console.log('‚úÖ Dashboard stats loaded');
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        window.addEventListener('load', async () => {
            if (adminAuth.currentUser) {
                adminAuth.updateUserDisplay();
            }

            // Load dashboard statistics
            await loadDashboardStats();

            // Load contact messages notification
            loadContactMessagesNotification();

            // Refresh contact messages every 30 seconds
            setInterval(loadContactMessagesNotification, 30000);

            // Debug: Check if calendar data is loaded
            if (window.calendarData) {
                console.log('‚úÖ CalendarData geladen:', window.calendarData.length, 'events');
            } else {
                console.error('‚ùå CalendarData NIET geladen!');
            }
        });
    </script>
    <script src="admin-script.js"></script>
</body>
</html>
